<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="filter_sale_product_report" model="ir.actions.report">
        <field name="name">طباعة جميع طلبات اليوم</field>
        <field name="model">sale.order</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">filter_sales_product_report.filter_sale_product_report_template_id</field>
        <field name="report_file">filter_sales_product_report.filter_sale_product_report_template_id</field>
        <field name="binding_model_id" ref="model_sale_order"/>
        <field name="binding_type">report</field>
    </record>

    <template id="filter_sale_product_report_template_id">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <t t-set="list_of_categ" t-value="[]"/>

                <t t-foreach="dict1" t-as="product">
                    <t t-if="dict1[product].get('category') not in list_of_categ">
                        <t t-set="dummy" t-value="list_of_categ.append(dict1[product].get('category'))"/>
                    </t>
                </t>

                <t t-foreach="list_of_categ" t-as="categ">
                    <h2 style="text-align: center;">
                        <t t-esc="categ"/>
                        الطلبات الخاصة ب
                    </h2>

                    <div>
                        <table style="border-collapse: collapse; width: 100%; border: 2px solid black;">
                            <thead>
                                <tr style="background-color: #96D4D4;">
                                    <th style="border-right: 2px solid black; padding: 10px; text-align: center;">
                                        الترقيم
                                    </th>
                                    <th style="border-right: 2px solid black; padding: 10px; text-align: center;">
                                        المنتج
                                    </th>
                                    <th style="border-right: 2px solid black; padding: 10px; text-align: center;">الكمية
                                        المطلوبة
                                    </th>
                                    <th style="border-right: 2px solid black; padding: 10px; text-align: center;">
                                        الوزن
                                    </th>
                                    <th style="border-right: 2px solid black; padding: 10px; text-align: center;">
                                        الوحدات
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="counter" t-value="1"/>
                                <t t-foreach="dict1" t-as="product">
                                    <t t-if="dict1[product].get('category') == categ">
                                        <tr style="border: 2px solid black;">
                                            <td style="padding: 10px; text-align: center; border: 2px solid black;">
                                                <t t-esc="counter"/>
                                                <t t-set="counter" t-value="counter+1"/>
                                            </td>
                                            <td style="padding: 10px; text-align: center; border: 2px solid black;">
                                                <t t-esc="dict1[product].get('name')"/>
                                            </td>
                                            <td style="padding: 10px; text-align: center; border: 2px solid black;">
                                                <t t-esc="dict1[product].get('quantity')"/>
                                            </td>
                                            <td style="padding: 10px; text-align: center; border: 2px solid black;">
                                                <t t-esc="dict1[product].get('uom')"/>
                                            </td>
                                            <td style="padding: 10px; text-align: center; border: 2px solid black;">
                                                <t t-esc="dict1[product].get('demand')"/>
                                            </td>
                                        </tr>
                                    </t>
                                </t>
                            </tbody>
                        </table>
                        <br/>
                        <br/>
                        <br/>
                    </div>
                </t>
            </t>
        </t>
    </template>
    <!--    <template id="filter_sale_product_report_template_id">-->
    <!--        <t t-call="web.html_container">-->
    <!--            <t t-call="web.external_layout">-->
    <!--                <t t-set="list_of_categ" t-value="[]"/>-->
    <!--                <t t-foreach="dict1" t-as="product">-->
    <!--                    <t t-if="dict1[product].get('category') not in list_of_categ">-->
    <!--                        <t t-set="dummy" t-value="list_of_categ.append(dict1[product].get('category'))"/>-->
    <!--                    </t>-->
    <!--                </t>-->
    <!--                <t t-foreach="list_of_categ" t-as="categ"> loop on list of categories-->
    <!--                    <t t-foreach="dict1" t-as="product"> loop in dictionary of products-->
    <!--                        <t t-if="dict1[product].get('category') == categ"> check if each product category equal the current category-->
    <!--                            <h2 style="text-align: center;">-->
    <!--                                <p>-->
    <!--                                    <t t-esc="categ"/>-->
    <!--                                    الطلبات الخاصة ب-->
    <!--                                </p>-->
    <!--                            </h2>-->
    <!--                            <div>-->
    <!--                                <table style="border-collapse: collapse; width: 100%; border: 2px solid black;">-->
    <!--                                    <thead>-->
    <!--                                        <tr style="background-color: #96D4D4; ">-->
    <!--                                            <th style="border-right: 2px solid black; padding: 10px; text-align: center;">-->
    <!--                                                الترقيم-->
    <!--                                            </th>-->
    <!--                                            <th style="border-right: 2px solid black; padding: 10px; text-align: center;">-->
    <!--                                                المنتج-->
    <!--                                            </th>-->
    <!--                                            <th style="border-right: 2px solid black; padding: 10px; text-align: center;">-->
    <!--                                                الكمية-->
    <!--                                                المطلوبة-->
    <!--                                            </th>-->
    <!--                                            <th style="border-right: 2px solid black; padding: 10px; text-align: center;">-->
    <!--                                                الوزن-->
    <!--                                            </th>-->
    <!--                                            <th style="border-right: 2px solid black; padding: 10px; text-align: center;">-->
    <!--                                                الوحدات-->
    <!--                                            </th>-->
    <!--                                        </tr>-->
    <!--                                    </thead>-->
    <!--                                    <tbody>-->
    <!--                                        <t t-foreach="dict1" t-as="product">-->
    <!--                                            <t t-if="dict1[product].get('category') == categ">-->
    <!--                                                <tr style="border: 2px solid black;">-->
    <!--                                                    <td style="padding: 10px; text-align: center; border: 2px solid black;">-->
    <!--                                                        <t t-esc="product_index+1"/>-->
    <!--                                                    </td>-->
    <!--                                                    <td style="padding: 10px; text-align: center; border: 2px solid black;">-->
    <!--                                                        <t t-esc="dict1[product].get('name')"/>-->
    <!--                                                    </td>-->
    <!--                                                    <td style="padding: 10px; text-align: center; border: 2px solid black;">-->
    <!--                                                        <t t-esc="dict1[product].get('quantity')"/>-->
    <!--                                                    </td>-->
    <!--                                                    <td style="padding: 10px; text-align: center; border: 2px solid black;">-->
    <!--                                                        <t t-esc="dict1[product].get('uom')"/>-->
    <!--                                                    </td>-->
    <!--                                                    <td style="padding: 10px; text-align: center; border: 2px solid black;">-->
    <!--                                                        <t t-esc="dict1[product].get('demand')"/>-->
    <!--                                                    </td>-->
    <!--                                                </tr>-->
    <!--                                            </t>-->
    <!--                                        </t>-->
    <!--                                    </tbody>-->
    <!--                                </table>-->
    <!--                            </div>-->
    <!--                        </t>-->
    <!--                    </t>-->
    <!--                </t>-->
    <!--            </t>-->
    <!--        </t>-->
    <!--    </template>-->


    <record id="view_custom_sale_order_tree" model="ir.ui.view">
        <field name="name">custom.sale.order.tree</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='order_line']//tree//field[@name='product_uom']" position="after">
                <field name="demand"/>
            </xpath>
        </field>
    </record>
</odoo>
